@import "../../../../../node_modules/bootstrap/scss/functions";
@import "../../../../../node_modules/bootstrap/scss/mixins/breakpoints";
@import "../../../custom";
@import "../../../bootstrap-override/mixins";
@import "../../../mixins";

.topic-navigation {
  position: sticky;
  top: 0;
  max-height: 100vh;
  overflow-y: auto;
  overflow-x: hidden;
  margin-top: 80px;

  @include media-breakpoint-down(md) {
    margin-bottom: 48px;
  }

  @include media-breakpoint-down(sm) {
    position: relative;
    max-height: none;
    overflow: visible;
  }

  &.in-viewport {
    position: relative;
    max-height: none; 
    overflow: visible;
    margin-bottom: 0;
  }

  &.is-sticky {
    margin-bottom: 80px;
  }

  &-heading {
    position: relative;
    margin-bottom: 22px;
    padding: 10px 10px 16px 5px;
    color: $text-gray;
    border-bottom: 2px solid $pink-underline;

    @include media-breakpoint-down(sm) {
      border: 1px solid $pink-underline;
      border-radius: 8px;
      padding: 10px 14px;

      &.menu-open {
        border-color: $blue;
      }
    }

    .section-label {
      @include typography-body-b;

      @include media-breakpoint-down(sm) {
        font-weight: 500;
      }
    }

    .mobile-menu-toggle {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      background: none;
      border: none;
      outline: none;

      &::after {
        content: "";
        position: absolute;
        top: 48%;
        transition: transform 0.5s ease-in-out;
        transform: translateY(-50%);
        right: 20px;
        width: 16px;
        height: 10px;
        background: url('/themes/custom/hq/img/caret-down.svg') no-repeat center;

        @include media-breakpoint-down(sm) {
          right: 10px;
        }
      }

      &[aria-expanded="true"] {
        &::after {
          transform: translateY(-50%) rotate(180deg);
        }
      }
    }

    @include media-breakpoint-up(sm) {
      .mobile-menu-toggle {
        display: none;
      }
    }
  }

  .see-more-button,
  .see-less-button {
    @include typography-body-menu;
    display: inline-block;
    padding: 12px 20px;
    color: $blue;
    background: none;
    border: none;
    cursor: pointer;

    &:hover {
      color: $blue-100;
    }
  }

  ul {
    list-style: none;
    padding: 0;
    margin: 0;

    li {
      @include typography-select2-m;

      .topic-link-wrapper {
        &:hover {

          a,
          .toggle {
            color: $blue;
          }
        }
      }
    }
  }

  .topic-item {
    position: relative;

    .topic-link-wrapper {
      &>a {
        display: inline-block;
        width: 100%;
        color: $darkish-gray;
        text-decoration: none;
      }
    }

    &.is-active {
      .topic-link-wrapper {
        &>a {
          color: $blue;
        }
      }
    }

    &.has-children {
      .topic-link-wrapper {
        position: relative;
      }
    }

    .toggle {
      position: absolute;
      left: 0;
      top: 0;
      width: 16px;
      height: auto;
      padding: 0;
      font-size: 22px;
      line-height: 1;
      color: $black;
      background: none;
      border: none;
      cursor: pointer;
      z-index: 1;
    }

    .topic-subtree {
      display: none;
      margin-left: 0;
      margin-top: 22px;

      .topic-item {
        &:not(:last-child) {
          margin-bottom: 12px;
        }

        &.level-1 {
          &.has-children {
            .topic-link-wrapper {
              &>a {
                margin-left: 20px;
                padding-right: 20px;
              }
            }
          }

          .topic-link-wrapper {
            >a {
              color: $brown;
              margin-left: 5px;
            }

            &:hover {

              a,
              .toggle {
                color: $blue;
              }
            }
          }

          &.is-active {
            .topic-link-wrapper {
              &>a {
                color: $blue;
              }
            }
          }
        }

        &.level-2 {
          .topic-link-wrapper {
            &>a {
              margin-left: 5px;
            }
          }
        }
      }
    }

    &.is-open {
      &>.topic-subtree {
        display: block;
      }
    }

    .hidden {
      display: none !important;
    }

    &.level-0 {
      margin-bottom: 22px;
      padding-bottom: 10px;

      &>.topic-link-wrapper {
        position: relative;

        &::after {
          content: "";
          position: absolute;
          display: flex;
          width: 100%;
          height: 1px;
          left: 0;
          bottom: -10px;
          background: $bluish-gray;
        }
      }

      &.has-children {
        .topic-subtree {
          margin-left: 15px;
        }

        &>.topic-link-wrapper {
          >a {
            padding-left: 20px;
          }
        }
      }
    }
  }
}

@include media-breakpoint-down(sm) {
  .topic-menu-content {
    display: none;

    &.open {
      position: absolute;
      top: 52px;
      display: block;
      width: 100%;
      padding: 16px;
      background: $white;
      box-shadow: 0px 12px 16px -4px $dark-blue-gray;
      border-radius: 0 0 6px 6px;
      z-index: 10;
    }
  }
}

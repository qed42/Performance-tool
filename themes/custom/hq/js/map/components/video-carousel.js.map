{"version":3,"names":[],"mappings":"","sources":["components/video-carousel.js"],"sourcesContent":["(function ($, Drupal, once) {\n  Drupal.behaviors.videoCarousel = {\n    attach: function (context) {\n      // Close popup on click outside or close button\n      once('video-popup-close', 'body', context).forEach(() => {\n        $('body').on('click', function (e) {\n          if (\n            $(e.target).is('#video-popup-overlay') ||\n            $(e.target).hasClass('video-popup-close')\n          ) {\n            closeVideoPopup();\n          }\n        });\n      });\n\n      // Close popup on ESC key\n      once('video-popup-esc', 'body', context).forEach(() => {\n        $(document).on('keydown.videoPopupEsc', function (e) {\n          if (e.key === 'Escape' || e.keyCode === 27) {\n            closeVideoPopup();\n          }\n        });\n      });\n\n      function getVideoSrc($iframe) {\n        // Support for both iframe and div[data-src] (social embed)\n        if ($iframe.length === 0) {\n          return null;\n        }\n        return $iframe.data('src') || $iframe.attr('src');\n      }\n\n      function openVideoPopup(src) {\n        if (!src) return;\n\n        if (!src.includes('autoplay=1')) {\n          src += (src.includes('?') ? '&' : '?') + 'autoplay=1';\n        }\n\n        const iframe = `<iframe src=\"${src}\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen></iframe>`;\n        $('#video-popup-overlay .video-popup-content').html(iframe);\n        $('#video-popup-overlay').removeClass('hidden');\n      }\n\n      function closeVideoPopup() {\n        $('#video-popup-overlay .video-popup-content').empty();\n        $('#video-popup-overlay').addClass('hidden');\n      }\n\n      function bindVideoPopupTriggers($wrapper, videoSrc) {\n        const $poster = $wrapper.find('.video-poster');\n        const $playButton = $wrapper.find('.video-play-button');\n\n        if (!videoSrc) return;\n\n        $poster.off('click').on('click', function () {\n          openVideoPopup(videoSrc);\n        });\n\n        $playButton.off('click').on('click', function () {\n          openVideoPopup(videoSrc);\n        });\n      }\n\n      // Swiper carousel setup\n      $('.paragraph--type--video-carousel .swiper-container', context).each(function () {\n        const $videoSwiperContainer = $(this);\n        if ($videoSwiperContainer.data('initialized')) return;\n        $videoSwiperContainer.data('initialized', true);\n      \n        const swiperId = $videoSwiperContainer.attr('id');\n        const $prev = $(`.swiper-button-prev[data-swiper-target=\"${swiperId}\"]`);\n        const $next = $(`.swiper-button-next[data-swiper-target=\"${swiperId}\"]`);\n      \n        // Bind popup triggers\n        $videoSwiperContainer.find('.video-wrapper').each(function () {\n          const $wrapper = $(this);\n          const $iframe = $wrapper.find('.video-iframe, .embedded-social-video iframe');\n          const videoSrc = getVideoSrc($iframe);\n          bindVideoPopupTriggers($wrapper, videoSrc);\n        });\n      \n        const itemsPerView = parseInt($videoSwiperContainer.data('items-per-view')) || 2;\n        const totalItems = $videoSwiperContainer.find('.swiper-slide').length;\n      \n        // Always use partial preview if 3 per view\n        let slidesPerView = itemsPerView === 3 ? 2.13 : itemsPerView;\n      \n        // Enable loop *only* if itemsPerView === 3 and totalItems === 3\n        const enableLoop = itemsPerView === 3 && totalItems === 3;\n      \n        const swiper = new Swiper($videoSwiperContainer[0], {\n          slidesPerView: 1,\n          spaceBetween: 40,\n          slidesPerGroup: 1,\n          freeMode: false,\n          simulateTouch: true,\n          grabCursor: true,\n          loop: enableLoop,\n          navigation: {\n            nextEl: $next[0],\n            prevEl: $prev[0]\n          },\n          breakpoints: {\n            641: {\n              slidesPerView: slidesPerView,\n              spaceBetween: 20\n            }\n          }\n        });\n      \n        // Hide arrows only if totalItems <= itemsPerView and loop is not enabled\n        if (!enableLoop && totalItems <= itemsPerView) {\n          $prev.hide();\n          $next.hide();\n        }\n      });\n\n      // Non-swiper (single video) layout binding\n      once('standalone-video-play', '.video-crousel__content .video-wrapper', context).forEach((wrapper) => {\n        const $wrapper = $(wrapper);\n        const $iframe = $wrapper.find('.video-iframe, .embedded-social-video iframe');\n        const videoSrc = getVideoSrc($iframe);\n        bindVideoPopupTriggers($wrapper, videoSrc);\n      });\n    }\n  };\n})(jQuery, Drupal, once);\n"],"file":"../../components/video-carousel.js"}